<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Language" content="en" />
<title>remove infinite borders skeleton - windowchef - windowchef is a stacking window cooker controlled by a remote control program, waitron
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="windowchef.git Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>windowchef</h1><span class="desc">windowchef is a stacking window cooker controlled by a remote control program, waitron
</span></td></tr><tr class="url"><td></td><td>git clone <a href="git://thetudor.ddns.net/windowchef.git">git://thetudor.ddns.net/windowchef.git</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a> | <a href="../file/LICENSE.html">LICENSE</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/6b1fa383d165f920e2b1c8c689e116e19f879f24.html">6b1fa383d165f920e2b1c8c689e116e19f879f24</a>
<b>parent</b> <a href="../commit/a44189ab8c0b250b54ff11bbb4184997a6969af4.html">a44189ab8c0b250b54ff11bbb4184997a6969af4</a>
<b>Author:</b> Tudor Roman &lt;<a href="mailto:xenogenesis@openmailbox.org">xenogenesis@openmailbox.org</a>&gt;
<b>Date:</b>   Tue Oct  4 19:43:55 +0300

remove infinite borders skeleton

<b>Diffstat:</b>
<table><tr><td><a href="#h0">README.md</a></td><td> | </td><td class="num">2</td><td><span class="i">+</span><span class="d">-</span></td></tr>
<tr><td><a href="#h1">ipc.h</a></td><td> | </td><td class="num">2</td><td><span class="i"></span><span class="d">--</span></td></tr>
<tr><td><a href="#h2">types.h</a></td><td> | </td><td class="num">6</td><td><span class="i"></span><span class="d">------</span></td></tr>
<tr><td><a href="#h3">wm.c</a></td><td> | </td><td class="num">68</td><td><span class="i">+</span><span class="d">-------------------------------------------------------------------</span></td></tr>
</table>4 files changed, 2 insertions(+), 76 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/README.md.html">README.md</a> b/<a href="../file/README.md.html">README.md</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -55,7 +55,7 @@ Features
</a> 
 ### Soon to come
 
<a href="#h0-0-3" id="h0-0-3" class="d">-- [ ] Configurable number of borders
</a><a href="#h0-0-4" id="h0-0-4" class="i">+- Nothing yet.
</a> 
 ### Groups
 
<b>diff --git a/<a id="h1" href="../file/ipc.h.html">ipc.h</a> b/<a href="../file/ipc.h.html">ipc.h</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -29,7 +29,6 @@ enum IPCCommand {
</a> 	IPCGroupActivate,
 	IPCGroupDeactivate,
 	IPCGroupToggle,
<a href="#h1-0-3" id="h1-0-3" class="d">-	IPCBorderSet,
</a> 	IPCWMQuit,
 	IPCWMConfig,
 	NR_IPC_COMMANDS
<a href="#h1-1" id="h1-1" class="h">@@ -44,7 +43,6 @@ enum IPCConfig {
</a> 	IPCConfigCursorPosition,
 	IPCConfigGroupsNr,
 	IPCConfigEnableSloppyFocus,
<a href="#h1-1-3" id="h1-1-3" class="d">-	IPCConfigNrOfBorders,
</a> 	NR_IPC_CONFIGS
 };
 
<b>diff --git a/<a id="h2" href="../file/types.h.html">types.h</a> b/<a href="../file/types.h.html">types.h</a></b>
<a href="#h2-0" id="h2-0" class="h">@@ -46,12 +46,6 @@ struct conf {
</a>     enum position cursor_position;
     uint32_t groups;
     bool sloppy_focus;
<a href="#h2-0-3" id="h2-0-3" class="d">-    uint8_t borders;
</a><a href="#h2-0-4" id="h2-0-4" class="d">-};
</a><a href="#h2-0-5" id="h2-0-5" class="d">-
</a><a href="#h2-0-6" id="h2-0-6" class="d">-struct border {
</a><a href="#h2-0-7" id="h2-0-7" class="d">-	int8_t width;
</a><a href="#h2-0-8" id="h2-0-8" class="d">-	uint32_t color;
</a> };
 
 #endif
<b>diff --git a/<a id="h3" href="../file/wm.c.html">wm.c</a> b/<a href="../file/wm.c.html">wm.c</a></b>
<a href="#h3-0" id="h3-0" class="h">@@ -41,7 +41,6 @@ static int  randr_base;
</a> static bool halt;
 static int  exit_code;
 static bool *group_in_use;
<a href="#h3-0-3" id="h3-0-3" class="d">-static struct border *borders_in_use;
</a> /* list of all windows. NULL is the empty list */
 static struct list_item *win_list   = NULL;
 static struct list_item *mon_list   = NULL;
<a href="#h3-1" id="h3-1" class="h">@@ -96,7 +95,6 @@ static struct client * find_client(xcb_window_t *);
</a> static bool get_geometry(xcb_window_t *, int16_t *, int16_t *, uint16_t *, uint16_t *);
 static void set_borders(struct client *client, uint32_t);
 static bool is_mapped(xcb_window_t);
<a href="#h3-1-3" id="h3-1-3" class="d">-static uint16_t get_border_width(xcb_window_t);
</a> static void free_window(struct client *);
 static void add_to_client_list(xcb_window_t);
 static void update_client_list(void);
<a href="#h3-2" id="h3-2" class="h">@@ -107,8 +105,6 @@ static void group_activate(uint32_t);
</a> static void group_deactivate(uint32_t);
 static void group_toggle(uint32_t);
 static void change_nr_of_groups(uint32_t);
<a href="#h3-2-3" id="h3-2-3" class="d">-static void change_nr_of_borders(uint8_t);
</a><a href="#h3-2-4" id="h3-2-4" class="d">-static void border_modify(uint8_t, uint8_t, uint32_t);
</a> static void register_event_handlers(void);
 static void event_configure_request(xcb_generic_event_t *);
 static void event_destroy_notify(xcb_generic_event_t *);
<a href="#h3-3" id="h3-3" class="h">@@ -230,12 +226,6 @@ setup(void)
</a> 	group_in_use = malloc(conf.groups * sizeof(bool));
 	for (uint32_t i = 0; i &lt; conf.groups; i++)
 		group_in_use[i] = false;
<a href="#h3-3-3" id="h3-3-3" class="d">-
</a><a href="#h3-3-4" id="h3-3-4" class="d">-	borders_in_use = malloc(conf.groups * sizeof(struct border));
</a><a href="#h3-3-5" id="h3-3-5" class="d">-	for (uint8_t i = 0; i &lt; conf.borders; i++) {
</a><a href="#h3-3-6" id="h3-3-6" class="d">-		borders_in_use[i].color = 0xffffff;
</a><a href="#h3-3-7" id="h3-3-7" class="d">-		borders_in_use[i].width = 0;
</a><a href="#h3-3-8" id="h3-3-8" class="d">-	}
</a> 	return 0;
 }
 
<a href="#h3-4" id="h3-4" class="h">@@ -752,12 +742,11 @@ static void
</a> move_window(xcb_window_t win, int16_t x, int16_t y)
 {
 	int16_t win_x, win_y;
<a href="#h3-4-3" id="h3-4-3" class="d">-	uint16_t win_w, win_h, win_b;
</a><a href="#h3-4-4" id="h3-4-4" class="i">+	uint16_t win_w, win_h;
</a> 
 	if (!is_mapped(win) || win == scr-&gt;root)
 		return;
 
<a href="#h3-4-9" id="h3-4-9" class="d">-	win_b = get_border_width(win);
</a> 	get_geometry(&amp;win, &amp;win_x, &amp;win_y, &amp;win_w, &amp;win_h);
 
 	win_x += x;
<a href="#h3-5" id="h3-5" class="h">@@ -1277,23 +1266,6 @@ is_mapped(xcb_window_t win)
</a> }
 
 /*
<a href="#h3-5-3" id="h3-5-3" class="d">- * Returns the widht of the window border in pixels.
</a><a href="#h3-5-4" id="h3-5-4" class="d">- */
</a><a href="#h3-5-5" id="h3-5-5" class="d">-
</a><a href="#h3-5-6" id="h3-5-6" class="d">-static uint16_t
</a><a href="#h3-5-7" id="h3-5-7" class="d">-get_border_width(xcb_window_t win)
</a><a href="#h3-5-8" id="h3-5-8" class="d">-{
</a><a href="#h3-5-9" id="h3-5-9" class="d">-	xcb_get_geometry_reply_t *r = xcb_get_geometry_reply(conn,
</a><a href="#h3-5-10" id="h3-5-10" class="d">-			xcb_get_geometry(conn, win),
</a><a href="#h3-5-11" id="h3-5-11" class="d">-			NULL);
</a><a href="#h3-5-12" id="h3-5-12" class="d">-	uint16_t w = r-&gt;border_width;
</a><a href="#h3-5-13" id="h3-5-13" class="d">-
</a><a href="#h3-5-14" id="h3-5-14" class="d">-	free(r);
</a><a href="#h3-5-15" id="h3-5-15" class="d">-
</a><a href="#h3-5-16" id="h3-5-16" class="d">-	return w;
</a><a href="#h3-5-17" id="h3-5-17" class="d">-}
</a><a href="#h3-5-18" id="h3-5-18" class="d">-
</a><a href="#h3-5-19" id="h3-5-19" class="d">-/*
</a>  * Deletes and frees a client from the list.
  */
 
<a href="#h3-6" id="h3-6" class="h">@@ -1443,43 +1415,6 @@ change_nr_of_groups(uint32_t groups)
</a> 	group_in_use = copy;
 }
 
<a href="#h3-6-3" id="h3-6-3" class="d">-static void
</a><a href="#h3-6-4" id="h3-6-4" class="d">-change_nr_of_borders(uint8_t border_nr)
</a><a href="#h3-6-5" id="h3-6-5" class="d">-{
</a><a href="#h3-6-6" id="h3-6-6" class="d">-	uint8_t to = border_nr &lt; conf.borders ? border_nr : conf.borders;
</a><a href="#h3-6-7" id="h3-6-7" class="d">-
</a><a href="#h3-6-8" id="h3-6-8" class="d">-	if (border_nr &gt;= conf.borders)
</a><a href="#h3-6-9" id="h3-6-9" class="d">-		return;
</a><a href="#h3-6-10" id="h3-6-10" class="d">-
</a><a href="#h3-6-11" id="h3-6-11" class="d">-	struct border *new_borders;
</a><a href="#h3-6-12" id="h3-6-12" class="d">-	new_borders = malloc(border_nr * sizeof(struct border));
</a><a href="#h3-6-13" id="h3-6-13" class="d">-
</a><a href="#h3-6-14" id="h3-6-14" class="d">-	if (new_borders == NULL)
</a><a href="#h3-6-15" id="h3-6-15" class="d">-		return;
</a><a href="#h3-6-16" id="h3-6-16" class="d">-
</a><a href="#h3-6-17" id="h3-6-17" class="d">-	for (uint8_t i = 0; i &lt; to; i++)
</a><a href="#h3-6-18" id="h3-6-18" class="d">-		new_borders[i] = borders_in_use[i];
</a><a href="#h3-6-19" id="h3-6-19" class="d">-
</a><a href="#h3-6-20" id="h3-6-20" class="d">-	if (border_nr &gt; conf.borders)
</a><a href="#h3-6-21" id="h3-6-21" class="d">-		for (uint8_t i = to; i &lt; border_nr; i++) {
</a><a href="#h3-6-22" id="h3-6-22" class="d">-			new_borders[i].width = 0;
</a><a href="#h3-6-23" id="h3-6-23" class="d">-			new_borders[i].color = 0xffffff;
</a><a href="#h3-6-24" id="h3-6-24" class="d">-		}
</a><a href="#h3-6-25" id="h3-6-25" class="d">-
</a><a href="#h3-6-26" id="h3-6-26" class="d">-	free(borders_in_use);
</a><a href="#h3-6-27" id="h3-6-27" class="d">-	borders_in_use = new_borders;
</a><a href="#h3-6-28" id="h3-6-28" class="d">-}
</a><a href="#h3-6-29" id="h3-6-29" class="d">-
</a><a href="#h3-6-30" id="h3-6-30" class="d">-static void
</a><a href="#h3-6-31" id="h3-6-31" class="d">-border_modify(uint8_t border_nr, uint8_t width, uint32_t color)
</a><a href="#h3-6-32" id="h3-6-32" class="d">-{
</a><a href="#h3-6-33" id="h3-6-33" class="d">-	if (border_nr &gt;= conf.borders)
</a><a href="#h3-6-34" id="h3-6-34" class="d">-		return;
</a><a href="#h3-6-35" id="h3-6-35" class="d">-
</a><a href="#h3-6-36" id="h3-6-36" class="d">-	borders_in_use[border_nr].width = width;
</a><a href="#h3-6-37" id="h3-6-37" class="d">-	borders_in_use[border_nr].color = color;
</a><a href="#h3-6-38" id="h3-6-38" class="d">-}
</a><a href="#h3-6-39" id="h3-6-39" class="d">-
</a> /*
  * Adds X event handlers to the array.
  */
<a href="#h3-7" id="h3-7" class="h">@@ -2330,7 +2265,6 @@ load_defaults(void)
</a> 	conf.cursor_position = CURSOR_POSITION;
 	conf.groups          = GROUPS;
 	conf.sloppy_focus    = SLOPPY_FOCUS;
<a href="#h3-7-3" id="h3-7-3" class="d">-	conf.borders         = 1;
</a> }
 
 static void
</pre>
</div>
</body>
</html>
