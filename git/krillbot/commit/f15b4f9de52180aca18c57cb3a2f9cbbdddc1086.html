<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Language" content="en" />
<title>added triggers - krillbot - Stupid telegram bot.
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="krillbot.git Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>krillbot</h1><span class="desc">Stupid telegram bot.
</span></td></tr><tr class="url"><td></td><td>git clone <a href="git://thetudor.ddns.net/krillbot.git">git://thetudor.ddns.net/krillbot.git</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/f15b4f9de52180aca18c57cb3a2f9cbbdddc1086.html">f15b4f9de52180aca18c57cb3a2f9cbbdddc1086</a>
<b>parent</b> <a href="../commit/0c787f36d5d670afa2cfa4ad9b188029f8e21f65.html">0c787f36d5d670afa2cfa4ad9b188029f8e21f65</a>
<b>Author:</b> Tudor &lt;<a href="mailto:xenogenesis@openmailbox.org">xenogenesis@openmailbox.org</a>&gt;
<b>Date:</b>   Tue Jun 28 12:35:12 +0300

added triggers

<b>Diffstat:</b>
<table><tr><td><a href="#h0">main.go</a></td><td> | </td><td class="num">12</td><td><span class="i">++++++++++</span><span class="d">--</span></td></tr>
<tr><td><a href="#h1">triggers.go</a></td><td> | </td><td class="num">26</td><td><span class="i">++++++++++++++++++++++++++</span><span class="d"></span></td></tr>
</table>2 files changed, 36 insertions(+), 2 deletions(-)
<hr/><b>diff --git a/<a id="h0" href="../file/main.go.html">main.go</a> b/<a href="../file/main.go.html">main.go</a></b>
<a href="#h0-0" id="h0-0" class="h">@@ -22,6 +22,7 @@ var Logger *log.Logger
</a> var Config ConfigStructure
 var Bot tgbotapi.BotAPI
 var Commands map[string]command
<a href="#h0-0-3" id="h0-0-3" class="i">+var Triggers map[string]command
</a> 
 func initLogger() *log.Logger {
 	return log.New(os.Stdout, &quot;&quot;, log.Lshortfile)
<a href="#h0-1" id="h0-1" class="h">@@ -35,6 +36,10 @@ func initCommands() {
</a> 	Commands[&quot;flip&quot;] = commandFlip
 }
 
<a href="#h0-1-3" id="h0-1-3" class="i">+func initTrigger() {
</a><a href="#h0-1-4" id="h0-1-4" class="i">+	Triggers[&quot;nu?&quot;] = triggerCorect
</a><a href="#h0-1-5" id="h0-1-5" class="i">+}
</a><a href="#h0-1-6" id="h0-1-6" class="i">+
</a> func main() {
 	var configFile = flag.String(&quot;config&quot;, &quot;config.json&quot;, &quot;path to the config file&quot;)
 
<a href="#h0-2" id="h0-2" class="h">@@ -68,6 +73,9 @@ func main() {
</a> 	Commands = make(map[string]command)
 	initCommands()
 
<a href="#h0-2-3" id="h0-2-3" class="i">+	Triggers = make(map[string]command)
</a><a href="#h0-2-4" id="h0-2-4" class="i">+	initTrigger()
</a><a href="#h0-2-5" id="h0-2-5" class="i">+
</a> 	for update := range updates {
 		if update.Message == nil {
 			continue
<a href="#h0-3" id="h0-3" class="h">@@ -76,8 +84,8 @@ func main() {
</a> 		// Reply to commands
 		if update.Message.Command() != &quot;&quot; &amp;&amp; Commands[update.Message.Command()] != nil {
 			Commands[update.Message.Command()](update, Bot)
<a href="#h0-3-3" id="h0-3-3" class="d">-		} else if update.Message.Text == &quot;nu?&quot; {
</a><a href="#h0-3-4" id="h0-3-4" class="d">-			Bot.Send(tgbotapi.NewMessage(update.Message.Chat.ID, &quot;mi se pare corect&quot;))
</a><a href="#h0-3-5" id="h0-3-5" class="i">+		} else if Triggers[update.Message.Text] != nil {
</a><a href="#h0-3-6" id="h0-3-6" class="i">+			Triggers[update.Message.Text](update, Bot)
</a> 		}
 	}
 }
<b>diff --git a/<a id="h1" href="../file/triggers.go.html">triggers.go</a> b/<a href="../file/triggers.go.html">triggers.go</a></b>
<a href="#h1-0" id="h1-0" class="h">@@ -0,0 +1,26 @@
</a><a href="#h1-0-0" id="h1-0-0" class="i">+package main
</a><a href="#h1-0-1" id="h1-0-1" class="i">+
</a><a href="#h1-0-2" id="h1-0-2" class="i">+import (
</a><a href="#h1-0-3" id="h1-0-3" class="i">+	&quot;math/rand&quot;
</a><a href="#h1-0-4" id="h1-0-4" class="i">+
</a><a href="#h1-0-5" id="h1-0-5" class="i">+	&quot;gopkg.in/telegram-bot-api.v4&quot;
</a><a href="#h1-0-6" id="h1-0-6" class="i">+)
</a><a href="#h1-0-7" id="h1-0-7" class="i">+
</a><a href="#h1-0-8" id="h1-0-8" class="i">+func getCorectMsgs() []string {
</a><a href="#h1-0-9" id="h1-0-9" class="i">+	return []string{
</a><a href="#h1-0-10" id="h1-0-10" class="i">+		&quot;mi se pare corect&quot;,
</a><a href="#h1-0-11" id="h1-0-11" class="i">+		&quot;ce-i corect e corect&quot;,
</a><a href="#h1-0-12" id="h1-0-12" class="i">+		&quot;https://www.youtube.com/watch?v=g8uJtcDhbko&quot;,
</a><a href="#h1-0-13" id="h1-0-13" class="i">+		&quot;cea mai buna forma de cand s-a inventat salamul&quot;,
</a><a href="#h1-0-14" id="h1-0-14" class="i">+		&quot;yee&quot;,
</a><a href="#h1-0-15" id="h1-0-15" class="i">+	}
</a><a href="#h1-0-16" id="h1-0-16" class="i">+}
</a><a href="#h1-0-17" id="h1-0-17" class="i">+
</a><a href="#h1-0-18" id="h1-0-18" class="i">+func triggerCorect(u tgbotapi.Update, b *tgbotapi.BotAPI) {
</a><a href="#h1-0-19" id="h1-0-19" class="i">+	msgs := getCorectMsgs()
</a><a href="#h1-0-20" id="h1-0-20" class="i">+	rand.Seed(int64(u.Message.MessageID))
</a><a href="#h1-0-21" id="h1-0-21" class="i">+	msg := tgbotapi.NewMessage(u.Message.Chat.ID, msgs[rand.Intn(len(msgs))])
</a><a href="#h1-0-22" id="h1-0-22" class="i">+	msg.ReplyToMessageID = u.Message.MessageID
</a><a href="#h1-0-23" id="h1-0-23" class="i">+
</a><a href="#h1-0-24" id="h1-0-24" class="i">+	b.Send(msg)
</a><a href="#h1-0-25" id="h1-0-25" class="i">+}
</a></pre>
</div>
</body>
</html>
