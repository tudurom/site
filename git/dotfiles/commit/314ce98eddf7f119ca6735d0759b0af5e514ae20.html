<!DOCTYPE html>
<html dir="ltr" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta http-equiv="Content-Language" content="en" />
<title>Shiny new bar, terminal font and HLWM fixes - dotfiles - My small load of configuration files and scripts.
</title>
<link rel="icon" type="image/png" href="../favicon.png" />
<link rel="alternate" type="application/atom+xml" title="dotfiles.git Atom Feed" href="../atom.xml" />
<link rel="stylesheet" type="text/css" href="../style.css" />
</head>
<body>
<table><tr><td><a href="../../"><img src="../logo.png" alt="" width="32" height="32" /></a></td><td><h1>dotfiles</h1><span class="desc">My small load of configuration files and scripts.
</span></td></tr><tr class="url"><td></td><td>git clone <a href="git://thetudor.ddns.net/dotfiles.git">git://thetudor.ddns.net/dotfiles.git</a></td></tr><tr><td></td><td>
<a href="../log.html">Log</a> | <a href="../files.html">Files</a> | <a href="../refs.html">Refs</a></td></tr></table>
<hr/>
<div id="content">
<pre><b>commit</b> <a href="../commit/314ce98eddf7f119ca6735d0759b0af5e514ae20.html">314ce98eddf7f119ca6735d0759b0af5e514ae20</a>
<b>parent</b> <a href="../commit/8adbf7079696e1e8c9ffa32ba7a90f9b70deeaf3.html">8adbf7079696e1e8c9ffa32ba7a90f9b70deeaf3</a>
<b>Author:</b> Tudor &lt;<a href="mailto:tudurom@gmail.com">tudurom@gmail.com</a>&gt;
<b>Date:</b>   Sun Dec 20 21:42:36 2015

Shiny new bar, terminal font and HLWM fixes

<b>Diffstat:</b>
 home/.Xresources                     |   4 +-
 home/.config/herbstluftwm/autostart  |   7 +--
 home/.scripts/desktop/panel/panel    |   9 +--
 home/.scripts/desktop/panel/panel.rb | 105 ++++++++++++++++++++++++++++++------
 home/.scripts/setwall                |   6 +-
 home/.vimrc                          |   2 +-
 home/.xinitrc                        |   4 +-
 home/Pictures/Monody.jpg             | Bin 0 -&gt; 2279594 bytes
 8 files changed, 107 insertions(+), 30 deletions(-)
<hr/><b>diff --git a/<a href="../file/home/.Xresources.html">home/.Xresources</a> b/<a href="../file/home/.Xresources.html">home/.Xresources</a></b>
<a href="#h0" id="h0" class="h">@@ -9,9 +9,9 @@ rofi.bw: 3
</a> ! Base16 Ocean
 ! Scheme: Chris Kempson (http://chriskempson.com)
 
<a href="#h0-3" id="h0-3" class="d">-URxvt.font: xft:Hack:size=12
</a><a href="#h0-4" id="h0-4" class="i">+URxvt.font: -misc-tamzenforpowerline-medium-r-normal--17-120-100-100-c-0-iso10646-1
</a> URxvt.scrollBar: false
<a href="#h0-6" id="h0-6" class="d">-URxvt.letterSpace: -1
</a><a href="#h0-7" id="h0-7" class="i">+!URxvt.letterSpace: -1
</a> urxvt*perl-ext-common: default,clipboard
 
 #define base00 #2b303b
<b>diff --git a/<a href="../file/home/.config/herbstluftwm/autostart.html">home/.config/herbstluftwm/autostart</a> b/<a href="../file/home/.config/herbstluftwm/autostart.html">home/.config/herbstluftwm/autostart</a></b>
<a href="#h0" id="h0" class="h">@@ -127,10 +127,10 @@ hc set frame_border_active_color &quot;$BG_COLOR&quot;
</a> hc set frame_border_normal_color &quot;$INACTIVE_BG_COLOR&quot;
 hc set frame_bg_normal_color &quot;$INACTIVE_BG_COLOR&quot;
 hc set frame_bg_active_color &quot;$BG_COLOR&quot;
<a href="#h0-3" id="h0-3" class="d">-hc set frame_border_width 1
</a><a href="#h0-4" id="h0-4" class="i">+hc set frame_border_width 0
</a> hc set always_show_frame 1
 hc set frame_bg_transparent 1
<a href="#h0-7" id="h0-7" class="d">-hc set frame_transparent_width 5
</a><a href="#h0-8" id="h0-8" class="i">+hc set frame_transparent_width 0
</a> hc set window_gap 10
 
 hc attr theme.active.color &quot;$(hc get frame_bg_active_color)&quot;
<a href="#h1" id="h1" class="h">@@ -146,7 +146,6 @@ hc attr theme.active.inner_color &apos;#3E4A00&apos;
</a> hc attr theme.active.outer_color &apos;#3E4A00&apos;
 hc attr theme.background_color &apos;#18242C&apos;
 
<a href="#h1-3" id="h1-3" class="d">-hc set window_gap 0
</a> hc set frame_padding 0
 hc set smart_window_surroundings 0
 hc set smart_frame_surroundings 1
<a href="#h2" id="h2" class="h">@@ -156,7 +155,7 @@ hc set mouse_recenter_gap 0
</a> hc unrule -F
 #hc rule class=XTerm tag=3 # move all xterms to tag 3
 #hc rule focus=on # normally focus new clients
<a href="#h2-3" id="h2-3" class="d">-hc rule focus=off # normally do not focus new clients
</a><a href="#h2-4" id="h2-4" class="i">+hc rule focus=on # normally do not focus new clients
</a> # give focus to most common terminals
 #hc rule class~&apos;(.*[Rr]xvt.*|.*[Tt]erm|Konsole)&apos; focus=on
 hc rule windowtype~&apos;_NET_WM_WINDOW_TYPE_(DIALOG|UTILITY|SPLASH)&apos; pseudotile=on
<b>diff --git a/<a href="../file/home/.scripts/desktop/panel/panel.html">home/.scripts/desktop/panel/panel</a> b/<a href="../file/home/.scripts/desktop/panel/panel.html">home/.scripts/desktop/panel/panel</a></b>
<a href="#h0" id="h0" class="h">@@ -2,13 +2,14 @@
</a> 
 . $HOME/.scripts/colors
 
<a href="#h0-3" id="h0-3" class="d">-barheight=24
</a><a href="#h0-4" id="h0-4" class="i">+barheight=30
</a> monitor=0
 mgeom=( $(herbstclient monitor_rect &quot;$monitor&quot;) )
 geom=&quot;${mgeom[2]}x$barheight+0+0&quot;
<a href="#h0-8" id="h0-8" class="d">-basefont=&quot;M+ 1p&quot;
</a><a href="#h0-9" id="h0-9" class="d">-iconfont=&quot;FontAwesome&quot;
</a><a href="#h0-10" id="h0-10" class="i">+basefont=&quot;-*-tamzen-medium-*-*-*-17-*-*-*-*-*-*-*&quot;
</a><a href="#h0-11" id="h0-11" class="i">+boldfont=&quot;-*-tamzen-bold-*-*-*-17-*-*-*-*-*-*-*&quot;
</a><a href="#h0-12" id="h0-12" class="i">+iconfont=&quot;-misc-tamsynmod-medium-r-normal--17-123-100-100-c-80-iso8859-1&quot;
</a> 
 herbstclient pad $monitor $(expr $barheight)
 
<a href="#h0-16" id="h0-16" class="d">-~/.scripts/desktop/panel/panel.rb | lemonbar -B &quot;$BAR_BG_COLOR&quot; -F &quot;$TEXT_COLOR&quot; -f &quot;$basefont&quot; -f &quot;$basefont:Bold&quot; -f &quot;$iconfont&quot; -g $geom -a 20| sh
</a><a href="#h0-17" id="h0-17" class="i">+~/.scripts/desktop/panel/panel.rb | lemonbar -B &quot;$BAR_BG_COLOR&quot; -F &quot;$TEXT_COLOR&quot; -f &quot;$basefont&quot; -f &quot;$boldfont&quot; -f &quot;$iconfont&quot; -g $geom -a 20| sh
</a><b>diff --git a/<a href="../file/home/.scripts/desktop/panel/panel.rb.html">home/.scripts/desktop/panel/panel.rb</a> b/<a href="../file/home/.scripts/desktop/panel/panel.rb.html">home/.scripts/desktop/panel/panel.rb</a></b>
<a href="#h0" id="h0" class="h">@@ -5,6 +5,16 @@ load `printf %s $HOME` + &quot;/.scripts/setcolor&quot;
</a> BOLD_FONT_INDEX=2
 ICON_FONT_INDEX=3
 
<a href="#h0-3" id="h0-3" class="i">+CLOCK_ICON   = &quot;\u00c9&quot;
</a><a href="#h0-4" id="h0-4" class="i">+SPEAKER_ICON = &quot;\u00c6&quot;
</a><a href="#h0-5" id="h0-5" class="i">+PLAYING_ICON = &quot;\u00e6&quot;
</a><a href="#h0-6" id="h0-6" class="i">+PAUSED_ICON  = &quot;\u00e7&quot;
</a><a href="#h0-7" id="h0-7" class="i">+STOPPED_ICON = &quot;\u00e5&quot;
</a><a href="#h0-8" id="h0-8" class="i">+BATTERY_CHARGING_ICON = &quot;\u00c2&quot;
</a><a href="#h0-9" id="h0-9" class="i">+BATTERY_FULL_ICON = &quot;\u00f0&quot;
</a><a href="#h0-10" id="h0-10" class="i">+BATTERY_HALF_ICON = &quot;\u00ef&quot;
</a><a href="#h0-11" id="h0-11" class="i">+BATTERY_EMPTY_ICON = &quot;\u00ee&quot;
</a><a href="#h0-12" id="h0-12" class="i">+
</a> #puts $colors[&quot;BG_COLOR&quot;]
 
 def bold(text)
<a href="#h1" id="h1" class="h">@@ -57,6 +67,7 @@ end
</a> class Widget
 
   def initialize()
<a href="#h1-3" id="h1-3" class="i">+    @align = :l
</a>   end
 
   def update()
<a href="#h2" id="h2" class="h">@@ -68,25 +79,36 @@ class Widget
</a>   def out()
   end
 
<a href="#h2-3" id="h2-3" class="i">+  def align()
</a><a href="#h2-4" id="h2-4" class="i">+    return @align
</a><a href="#h2-5" id="h2-5" class="i">+  end
</a><a href="#h2-6" id="h2-6" class="i">+
</a> end
 
 class WidgetManager &lt; Widget
 
   def initialize()
<a href="#h2-12" id="h2-12" class="d">-    @widgets = []
</a><a href="#h2-13" id="h2-13" class="i">+    @widgets = { :l =&gt; [], :c =&gt; [], :r =&gt; [] }
</a>   end
 
   def add(widget)
<a href="#h2-17" id="h2-17" class="d">-    @widgets.push widget
</a><a href="#h2-18" id="h2-18" class="i">+    @widgets[widget.align].push widget
</a>   end
 
   def update()
<a href="#h2-22" id="h2-22" class="d">-    @widgets.each do |widget|
</a><a href="#h2-23" id="h2-23" class="d">-      widget.update()
</a><a href="#h2-24" id="h2-24" class="d">-    end
</a>     @out = &quot;&quot;
<a href="#h2-26" id="h2-26" class="d">-    @widgets.each do |widget|
</a><a href="#h2-27" id="h2-27" class="d">-      @out += widget.out + &quot; &quot;
</a><a href="#h2-28" id="h2-28" class="i">+    @widgets.each do |align, widgets_with_align|
</a><a href="#h2-29" id="h2-29" class="i">+      @out += &quot;%{#{align.to_s}}&quot;
</a><a href="#h2-30" id="h2-30" class="i">+      widgets_with_align.each_with_index do |widget, index|
</a><a href="#h2-31" id="h2-31" class="i">+        widget.update
</a><a href="#h2-32" id="h2-32" class="i">+        @out += widget.out
</a><a href="#h2-33" id="h2-33" class="i">+        if index &lt; widgets_with_align.length - 1
</a><a href="#h2-34" id="h2-34" class="i">+          widgets_with_align[index + 1].update
</a><a href="#h2-35" id="h2-35" class="i">+          if widgets_with_align[index + 1].out.strip != &quot;&quot;
</a><a href="#h2-36" id="h2-36" class="i">+            @out += separator
</a><a href="#h2-37" id="h2-37" class="i">+          end
</a><a href="#h2-38" id="h2-38" class="i">+        end
</a><a href="#h2-39" id="h2-39" class="i">+      end
</a>     end
 
   end
<a href="#h3" id="h3" class="h">@@ -104,8 +126,6 @@ end
</a> 
 class HLWMTags &lt; Widget
 
<a href="#h3-3" id="h3-3" class="d">-  def initialize()
</a><a href="#h3-4" id="h3-4" class="d">-  end
</a> 
   def out()
     return @out
<a href="#h4" id="h4" class="h">@@ -131,7 +151,7 @@ class HLWMTags &lt; Widget
</a>         @out += bg(&quot;-&quot;, fg(&quot;#ababab&quot;, text))
       end
     end
<a href="#h4-3" id="h4-3" class="d">-    @out += separator + fg(&quot;#ababab&quot;, `xtitle`.strip())
</a><a href="#h4-4" id="h4-4" class="i">+    @out += fg(&quot;#ababab&quot;, `xtitle`.strip())
</a> 
   end
 
<a href="#h5" id="h5" class="h">@@ -143,8 +163,12 @@ end
</a> 
 class TimeW &lt; Widget
 
<a href="#h5-3" id="h5-3" class="i">+  def initialize
</a><a href="#h5-4" id="h5-4" class="i">+    @align = :r
</a><a href="#h5-5" id="h5-5" class="i">+  end
</a><a href="#h5-6" id="h5-6" class="i">+
</a>   def update()
<a href="#h5-8" id="h5-8" class="d">-    @out = &quot;%{r}&quot; + icon(&quot;\uf017&quot;) + &quot; &quot; + `date +&quot;%A, %d %B %H:%I&quot;`.strip + separator
</a><a href="#h5-9" id="h5-9" class="i">+    @out = icon(CLOCK_ICON) + &quot; &quot; + Time.now.strftime(&quot;%A, %m %B %I:%M&quot;)
</a>   end
 
   def render()
<a href="#h6" id="h6" class="h">@@ -158,20 +182,24 @@ end
</a> 
 class PlayerctlW &lt; Widget
 
<a href="#h6-3" id="h6-3" class="i">+  def initialize
</a><a href="#h6-4" id="h6-4" class="i">+    @align = :r
</a><a href="#h6-5" id="h6-5" class="i">+  end
</a><a href="#h6-6" id="h6-6" class="i">+
</a>   def update()
     status = `playerctl status`.strip()
     if status != &quot;&quot;
       statuses = {
<a href="#h6-11" id="h6-11" class="d">-        &quot;Playing&quot; =&gt; &quot;\uf04b&quot;,
</a><a href="#h6-12" id="h6-12" class="d">-        &quot;Paused&quot;  =&gt; &quot;\uf04c&quot;,
</a><a href="#h6-13" id="h6-13" class="d">-        &quot;Stopped&quot; =&gt; &quot;\uf04d&quot;
</a><a href="#h6-14" id="h6-14" class="i">+        &quot;Playing&quot; =&gt; PLAYING_ICON,
</a><a href="#h6-15" id="h6-15" class="i">+        &quot;Paused&quot;  =&gt; PAUSED_ICON,
</a><a href="#h6-16" id="h6-16" class="i">+        &quot;Stopped&quot; =&gt; STOPPED_ICON
</a>       }
       buttons = []
       buttons[0] = Button.new(1, &quot;playerctl play-pause&quot;)
       buttons[1] = Button.new(3, &quot;playerctl stop&quot;)
       artist = `playerctl metadata artist`
       title = `playerctl metadata title`
<a href="#h6-23" id="h6-23" class="d">-      @out = bold(&quot;#{icon(statuses[status])} #{click(artist + &apos; - &apos; + title, buttons)}&quot;)
</a><a href="#h6-24" id="h6-24" class="i">+      @out = &quot;#{icon(statuses[status])} #{click(bold(artist + &apos; - &apos; + title), buttons)} &quot;
</a>     else
       @out = &quot; &quot;
     end
<a href="#h7" id="h7" class="h">@@ -188,13 +216,16 @@ end
</a> 
 class VolumeW &lt; Widget
 
<a href="#h7-3" id="h7-3" class="i">+  def initialize
</a><a href="#h7-4" id="h7-4" class="i">+    @align = :r
</a><a href="#h7-5" id="h7-5" class="i">+  end
</a>   def update()
     buttons = [Button.new(3, &quot;amixer -D pulse sset Master toggle&quot;),
                Button.new(4, &quot;amixer -D pulse sset Master 5%+&quot;),
                Button.new(5, &quot;amixer -D pulse sset Master 5%-&quot;)]
 
 
<a href="#h7-12" id="h7-12" class="d">-    @out = &quot;#{icon(&quot;\uf028&quot;)} &quot; + `~/.scripts/desktop/panel/volume`.strip.chomp(&apos;%&apos;) + separator
</a><a href="#h7-13" id="h7-13" class="i">+    @out = &quot;#{icon(SPEAKER_ICON)} &quot; + click(`~/.scripts/desktop/panel/volume`.strip.chomp(&apos;%&apos;), buttons)
</a>   end
 
   def out()
<a href="#h8" id="h8" class="h">@@ -206,14 +237,56 @@ class VolumeW &lt; Widget
</a>   end
 end
 
<a href="#h8-3" id="h8-3" class="i">+class BatteryW &lt; Widget
</a><a href="#h8-4" id="h8-4" class="i">+
</a><a href="#h8-5" id="h8-5" class="i">+  def initialize
</a><a href="#h8-6" id="h8-6" class="i">+    @align = :r
</a><a href="#h8-7" id="h8-7" class="i">+  end
</a><a href="#h8-8" id="h8-8" class="i">+
</a><a href="#h8-9" id="h8-9" class="i">+  def update
</a><a href="#h8-10" id="h8-10" class="i">+    regex = /(\w+), (\d+)%(, (\d+):(\d+):(\d+))?/
</a><a href="#h8-11" id="h8-11" class="i">+    out = `acpi -b`
</a><a href="#h8-12" id="h8-12" class="i">+    regex.match(out)
</a><a href="#h8-13" id="h8-13" class="i">+    status = $~[1]
</a><a href="#h8-14" id="h8-14" class="i">+    percentage = $~[2].to_i
</a><a href="#h8-15" id="h8-15" class="i">+    hours = $~[4]
</a><a href="#h8-16" id="h8-16" class="i">+    minutes = $~[5]
</a><a href="#h8-17" id="h8-17" class="i">+    icon = &quot;&quot;
</a><a href="#h8-18" id="h8-18" class="i">+    if status == &quot;Charging&quot;
</a><a href="#h8-19" id="h8-19" class="i">+      icon = BATTERY_CHARGING_ICON
</a><a href="#h8-20" id="h8-20" class="i">+    elsif percentage &gt;= 50
</a><a href="#h8-21" id="h8-21" class="i">+      icon = BATTERY_FULL_ICON
</a><a href="#h8-22" id="h8-22" class="i">+    elsif percentage &lt; 50 and percentage &gt;= 20
</a><a href="#h8-23" id="h8-23" class="i">+      icon = BATTERY_HALF_ICON
</a><a href="#h8-24" id="h8-24" class="i">+    else
</a><a href="#h8-25" id="h8-25" class="i">+      icon = BATTERY_EMPTY_ICON
</a><a href="#h8-26" id="h8-26" class="i">+    end
</a><a href="#h8-27" id="h8-27" class="i">+
</a><a href="#h8-28" id="h8-28" class="i">+    @out = icon(icon) + &quot; &quot; + percentage.to_s
</a><a href="#h8-29" id="h8-29" class="i">+    if hours != nil
</a><a href="#h8-30" id="h8-30" class="i">+      @out += &quot; (#{hours}:#{minutes})&quot;
</a><a href="#h8-31" id="h8-31" class="i">+    end
</a><a href="#h8-32" id="h8-32" class="i">+  end
</a><a href="#h8-33" id="h8-33" class="i">+
</a><a href="#h8-34" id="h8-34" class="i">+  def out
</a><a href="#h8-35" id="h8-35" class="i">+    return @out
</a><a href="#h8-36" id="h8-36" class="i">+  end
</a><a href="#h8-37" id="h8-37" class="i">+
</a><a href="#h8-38" id="h8-38" class="i">+  def render
</a><a href="#h8-39" id="h8-39" class="i">+    print @out
</a><a href="#h8-40" id="h8-40" class="i">+  end
</a><a href="#h8-41" id="h8-41" class="i">+end
</a><a href="#h8-42" id="h8-42" class="i">+
</a> tags = HLWMTags.new
 time = TimeW.new
 volume = VolumeW.new
<a href="#h8-46" id="h8-46" class="i">+batt = BatteryW.new
</a> pctl = PlayerctlW.new
 manager = WidgetManager.new
 manager.add tags
 manager.add time
 manager.add volume
<a href="#h8-52" id="h8-52" class="i">+manager.add batt
</a> manager.add pctl
 
 while true
<b>diff --git a/<a href="../file/home/.scripts/setwall.html">home/.scripts/setwall</a> b/<a href="../file/home/.scripts/setwall.html">home/.scripts/setwall</a></b>
<a href="#h0" id="h0" class="h">@@ -18,9 +18,9 @@ date = time.strftime(&apos;%d/%m&apos;)
</a> rnd = random.randrange(1, 101)
 
 if donger or date == &apos;01/04&apos;:
<a href="#h0-3" id="h0-3" class="d">-    os.system(&apos;feh --bg-scale ~/Pictures/april_wall.png&apos;)
</a><a href="#h0-4" id="h0-4" class="i">+    os.system(&apos;feh --bg-fill ~/Pictures/april_wall.png&apos;)
</a> elif finger or rnd == 2:
<a href="#h0-6" id="h0-6" class="d">-    os.system(&apos;feh --bg-scale ~/Pictures/surprise_wall.png&apos;)
</a><a href="#h0-7" id="h0-7" class="i">+    os.system(&apos;feh --bg-fill ~/Pictures/surprise_wall.png&apos;)
</a> else:
<a href="#h0-9" id="h0-9" class="d">-    os.system(&apos;feh --bg-scale ~/Pictures/wallpaper.png&apos;)
</a><a href="#h0-10" id="h0-10" class="i">+    os.system(&apos;feh --bg-fill ~/Pictures/Monody.jpg&apos;)
</a> 
<b>diff --git a/<a href="../file/home/.vimrc.html">home/.vimrc</a> b/<a href="../file/home/.vimrc.html">home/.vimrc</a></b>
<a href="#h0" id="h0" class="h">@@ -49,7 +49,7 @@ set smartindent
</a> set cindent
 set t_Co=256
 let base16colorspace=256
<a href="#h0-3" id="h0-3" class="d">-colorscheme base16-ocean 
</a><a href="#h0-4" id="h0-4" class="i">+colorscheme base16-ocean
</a> set background=dark
 let g:airline_powerline_fonts = 1
 set laststatus=2
<b>diff --git a/<a href="../file/home/.xinitrc.html">home/.xinitrc</a> b/<a href="../file/home/.xinitrc.html">home/.xinitrc</a></b>
<a href="#h0" id="h0" class="h">@@ -48,6 +48,10 @@ if [ -d /etc/X11/xinit/xinitrc.d ] ; then
</a>  unset f
 fi
 
<a href="#h0-3" id="h0-3" class="i">+xset +fp ~/.fonts/tamzen-font/bdf
</a><a href="#h0-4" id="h0-4" class="i">+xset +fp ~/.fonts/tamsynmod
</a><a href="#h0-5" id="h0-5" class="i">+xset fp rehash
</a><a href="#h0-6" id="h0-6" class="i">+
</a> #xrandr --output VIRTUAL1 --off --output LVDS1 --mode 1600x900 --pos 1920x180 --rotate normal --output VGA1 --primary --mode 1920x1080 --pos 0x0 --rotate normal
 xrandr --output VIRTUAL1 --off --output LVDS1 --mode 1600x900 --pos 2128x180 --rotate normal --output VGA1 --primary --mode 1920x1080 --pos 0x0 --rotate normal
 compton -b &amp;
<b>diff --git a/<a href="../file/home/Pictures/Monody.jpg.html">home/Pictures/Monody.jpg</a> b/<a href="../file/home/Pictures/Monody.jpg.html">home/Pictures/Monody.jpg</a></b>
Binary files differ
</pre>
</div>
</body>
</html>
